version: '3.8'

services:
  # ============================================
  # 통합 대시보드 (메인 관리 인터페이스)
  # ============================================
  dashboard_api:
    build:
      context: ./dashboard
      dockerfile: Dockerfile
    container_name: trading_dashboard
    restart: always
    ports:
      - "8000:8000"
    volumes:
      - ./dashboard:/app
      - ./Real_5m:/app/Real_5m
      - ./Deploy_15m:/app/Deploy_15m
      - ./BTC_30m:/app/BTC_30m
      - ./Bybit_1h:/app/Bybit_1h
    environment:
      - PYTHONUNBUFFERED=1
      - TZ=Asia/Seoul
    command: python -u bot_manager.py
    networks:
      - trading_network

  # ============================================
  # 1. BTC 30분봉 봇
  # ============================================
  btc_30m_bot:
    build:
      context: ./BTC_30m
      dockerfile: Dockerfile
    container_name: btc_30m_bot
    restart: always
    volumes:
      - ./BTC_30m:/app
    environment:
      - PYTHONUNBUFFERED=1
      - TZ=Asia/Seoul
    env_file:
      - .env
    command: python -u live_bot.py
    networks:
      - trading_network

  # ============================================
  # 2. Real Trading Bot 5분봉
  # ============================================
  real_5m_bot:
    build:
      context: ./Real_5m
      dockerfile: Dockerfile
    container_name: real_5m_bot
    restart: always
    volumes:
      - ./Real_5m:/app
    environment:
      - PYTHONUNBUFFERED=1
      - TZ=Asia/Seoul
    env_file:
      - .env
    command: python -u live_trading_bot.py
    networks:
      - trading_network

  # ============================================
  # 3. Deploy 15분봉 봇
  # ============================================
  deploy_15m_bot:
    build:
      context: ./Deploy_15m
      dockerfile: Dockerfile
    container_name: deploy_15m_bot
    restart: always
    volumes:
      - ./Deploy_15m:/app
    environment:
      - PYTHONUNBUFFERED=1
      - TZ=Asia/Seoul
    env_file:
      - .env
    command: python -u main.py
    networks:
      - trading_network

  # ============================================
  # 4. Bybit 1시간봉 봇
  # ============================================
  bybit_1h_bot:
    build:
      context: ./Bybit_1h
      dockerfile: Dockerfile
    container_name: bybit_1h_bot
    restart: always
    volumes:
      - ./Bybit_1h:/app
    environment:
      - PYTHONUNBUFFERED=1
      - TZ=Asia/Seoul
    env_file:
      - .env
    command: python -u live_trader_bybit.py
    networks:
      - trading_network

networks:
  trading_network:
    driver: bridge
